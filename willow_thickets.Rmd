---
title: "willow_thickets"
author: "Lydia Bleifuss"
date: "5/2/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##Willow Thicket:
Riparian buffer is 8.6 acres
40 samples of 10x10 ft 
Coversabout 10% of riparian buffer

```{r load, echo=TRUE, message=FALSE}
library(DeclareDesign)
library(knitr)
library(ggplot2)
library(grid)
library(gridExtra)
library(dplyr)
library(kableExtra)
```

```{r willow pop, echo=TRUE, message=F, eval=TRUE, cache=TRUE}
#declaring population of willows 
set.seed(228)
population <- declare_population(
  willows = add_level(N=3744,
                      main=draw_count(N=N, mean = 25),
                      willow_count=runif(n=N, min=0, max=50))
)

population
```


```{r willow-sample, echo=TRUE, message=F, eval=TRUE}
#Drawing a sample
sam <- sample(1:3744,40)
plot2 <- ggplot(population, aes(x=willow_count)) + 
  geom_histogram(color="black", fill="white") +
  geom_histogram(data=population[sam,], fill = "black")

sam

```


```{r mean-compare}
## Realizations vs. expectations
mean(population$willow_count)
#[1] 24.94215
willow_mean <- mean(population$willow_count)

mean(population[sam,"willow_count"])
#[1] 25.07221
```

```{r sd-vs-se}
## Standard deviation vs. standard error

#sd(population[sam,"willow_count"]) #standard deviation of sample
# [1] 14.47128

#sd(store) #standard error of sample
#[1] 2.344473

```


```{r declare-report}

## DeclareDesign

my_estimand <- declare_estimands(mean(willow_count),
                                 label = "Ybar")

sampling <- declare_sampling(N=40)


answer <- declare_estimator(
  handler = tidy_estimator(willow_mean),
  estimand = my_estimand) #simple mean, works without stratification (take out R==1)

answer

```



```{r diagnosis}
## DeclareDesign
design <- population + sampling + my_estimand + answer

diagnosis <- diagnose_design(design, sims = 1000)

diagnosis$diagnosands_df[n=40] %>%
  kable()
```
